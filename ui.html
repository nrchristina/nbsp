<!DOCTYPE html>
<html>
<head>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      padding: 16px;
      padding-bottom: 32px;
      background: #ffffff;
      position: relative;
    }
    
    h1 {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 16px;
      color: #000000;
    }
    
    .section {
      margin-bottom: 20px;
    }
    
    label {
      display: block;
      font-size: 12px;
      font-weight: 500;
      margin-bottom: 8px;
      color: #333333;
    }
    
    select {
      width: 100%;
      padding: 8px;
      border: 1px solid #e5e5e5;
      border-radius: 4px;
      font-size: 12px;
      background: #ffffff;
      cursor: pointer;
    }
    
    select:focus {
      outline: none;
      border-color: #18a0fb;
    }
    
    button {
      width: 100%;
      padding: 10px;
      background: #18a0fb;
      color: #ffffff;
      border: none;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      margin-top: 8px;
    }
    
    button:hover {
      background: #1592e6;
    }
    
    button:disabled {
      background: #cccccc;
      cursor: not-allowed;
    }
    
    .message {
      padding: 12px;
      border-radius: 4px;
      margin-top: 16px;
      font-size: 12px;
      display: none;
    }
    
    .message.success {
      background: #e8f5e9;
      color: #2e7d32;
      border: 1px solid #4caf50;
      display: block;
    }
    
    .message.error {
      background: #ffebee;
      color: #c62828;
      border: 1px solid #f44336;
      display: block;
    }
    
    .version {
      position: absolute;
      bottom: 8px;
      right: 12px;
      font-size: 10px;
      color: #999999;
      font-weight: 400;
    }
  </style>
</head>
<body>
  <h1>&nbsp;</h1>
  
  <div class="section">
    <label for="scope">Select scope:</label>
    <select id="scope">
      <option value="selection">Selected frame/element</option>
      <option value="page">Current page</option>
      <option value="file">Entire file</option>
    </select>
  </div>
  
  <button id="processBtn">Process Text</button>
  
  <div id="message" class="message"></div>
  
  <div class="version">version 2.19</div>
  
  <script>
    const scopeSelect = document.getElementById('scope');
    const processBtn = document.getElementById('processBtn');
    const messageDiv = document.getElementById('message');
    
    processBtn.addEventListener('click', () => {
      const scope = scopeSelect.value;
      processBtn.disabled = true;
      processBtn.textContent = 'Processing...';
      messageDiv.className = 'message';
      
      parent.postMessage({ pluginMessage: { type: 'process', scope } }, '*');
    });
    
    window.onmessage = (event) => {
      const msg = event.data.pluginMessage;
      
      if (msg.type === 'result') {
        processBtn.disabled = false;
        processBtn.textContent = 'Process Text';
        
        if (msg.success) {
          messageDiv.className = 'message success';
          messageDiv.textContent = `Success! Replaced ${msg.count} space${msg.count !== 1 ? 's' : ''} with non-breaking spaces.`;
        } else {
          messageDiv.className = 'message error';
          messageDiv.textContent = `Error: ${msg.error || 'Unknown error occurred.'}`;
        }
      }
    };
  </script>
</body>
</html>